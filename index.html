<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nat's Pondering Pond</title>
<link href="https://fonts.googleapis.com/css2?family=Delius&display=swap" rel="stylesheet">
<style>
body {
    font-family: "Delius", cursive;
    background: #FFF9F0; /* Cream background */
    margin: 0;
    padding: 30px;
    text-align: center;
}

h1 {
    font-size: 48px;
    color: #1f4d2d;
    margin-bottom: 10px;
}

.subtitle {
    font-size: 24px;
    color: #1f4d2d;
    margin-bottom: 30px;
}

.main-layout {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 60px;
    margin-top: 40px;
}

/* Pond Left */
.pond-wrapper {
    position: relative;
    width: 650px;
}

.pond {
    width: 100%;
    /* Floating animation */
    animation: float 4s ease-in-out infinite;
    transform-origin: center;
}

@keyframes float {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-15px);
    }
}

.drawing-container img {
    position: absolute;
    width: 100px; /* slightly bigger */
    border: 2px solid black; /* black outline like a button */
    border-radius: 12px;
    transform: translate(-50%, -50%) scale(0);
    animation: pop 0.4s ease-out forwards, float-item 4s ease-in-out infinite;
}

@keyframes pop {
    to { transform: translate(-50%, -50%) scale(1); }
}

/* Floating animation for items - slightly delayed for natural effect */
@keyframes float-item {
    0%, 100% {
        transform: translate(-50%, -50%) scale(1) translateY(0);
    }
    50% {
        transform: translate(-50%, -50%) scale(1) translateY(-8px);
    }
}

/* Right panel tools */
.toolbox {
    width: 300px;
    text-align: center;
}

.tool-title {
    font-size: 26px;
    margin-bottom: 20px;
}

.colors-and-canvas {
    display: flex;
    gap: 18px;
}

.color-column {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.color-dot {
    width: 36px; /* slightly bigger */
    height: 36px;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid black; /* outline like a button */
    transition: transform 0.2s;
}

.color-dot:hover {
    transform: scale(1.2);
}

#draw-area {
    width: 240px;
    height: 240px;
    background: #FFF9F0; /* match cream background */
    border: 3px dashed #444;
    margin-left: 10px;
    cursor: crosshair;
}

button {
    cursor: pointer;
    font-family: "Delius", cursive;
    font-size: 22px;
    padding: 10px 20px;
    margin-top: 15px;
    border: 3px solid #1f4d2d; /* dark green outline */
    border-radius: 12px;
    background: #FFF9F0;
    transition: transform 0.2s, background 0.3s;
}

button:hover {
    transform: scale(1.05);
    background: #e8f4ea;
}

/* Gallery button at bottom right */
.gallery-link {
    position: fixed;
    bottom: 30px;
    right: 30px;
    padding: 12px 20px;
    font-size: 20px;
    text-decoration: none;
    border: 3px solid #1f4d2d;
    border-radius: 12px;
    background: #FFF9F0;
    color: #1f4d2d;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    transition: transform 0.2s, background 0.3s;
}

.gallery-link:hover {
    transform: scale(1.05);
    background: #e8f4ea;
}

/* Clear button */
.clear-btn {
    background: #ffe6e6;
    margin-left: 10px;
}

.clear-btn:hover {
    background: #ffcccc;
}

/* Instructions */
.instructions {
    font-size: 18px;
    color: #555;
    margin-top: 20px;
    max-width: 300px;
    margin-left: auto;
    margin-right: auto;
}
</style>
</head>

<body>

<h1>Nat's Pondering Pond</h1>
<div class="subtitle">Add your thoughts and watch them float away...</div>

<div class="main-layout">

    <!-- Left: Pond -->
    <div class="pond-wrapper">
        <img src="https://i.imgur.com/3sXWJ2v.png" class="pond" alt="Pond">
        <div id="pondDrawings" class="drawing-container"></div>
    </div>

    <!-- Right: Tools -->
    <div class="toolbox">

        <h2 class="tool-title">Drop Something Into Our Pond?</h2>

        <div class="colors-and-canvas">

            <div class="color-column">
                <div class="color-dot" style="background:#c43a3a" onclick="selectColor('#c43a3a')"></div>
                <div class="color-dot" style="background:#f57c00" onclick="selectColor('#f57c00')"></div>
                <div class="color-dot" style="background:#f9d66b" onclick="selectColor('#f9d66b')"></div>
                <div class="color-dot" style="background:#f9a7c1" onclick="selectColor('#f9a7c1')"></div>
                <div class="color-dot" style="background:#1f4d2d" onclick="selectColor('#1f4d2d')"></div>
            </div>

            <canvas id="draw-area"></canvas>

        </div>

        <button onclick="addToPond()">Add to Pond</button>
        <button class="clear-btn" onclick="clearCanvas()">Clear Canvas</button>
        
        <div class="instructions">
            Draw something in the canvas, then click "Add to Pond" to see it float in the pond!
        </div>

    </div>
</div>

<a href="gallery.html" class="gallery-link">Gallery of Lost & Found</a>

<script>
// DRAWING LOGIC
const canvas = document.getElementById("draw-area");
const ctx = canvas.getContext("2d");
canvas.width = 240;
canvas.height = 240;

// Set initial canvas background
ctx.fillStyle = '#FFF9F0';
ctx.fillRect(0, 0, canvas.width, canvas.height);

let drawing = false;
let currentColor = "#1f4d2d";

function selectColor(c) { 
    currentColor = c; 
}

canvas.addEventListener("mousedown", startDrawing);
canvas.addEventListener("mouseup", stopDrawing);
canvas.addEventListener("mousemove", draw);
canvas.addEventListener("touchstart", handleTouchStart, { passive: false });
canvas.addEventListener("touchmove", handleTouchMove, { passive: false });
canvas.addEventListener("touchend", handleTouchEnd);

function startDrawing(e) {
    drawing = true;
    draw(e);
}

function stopDrawing() {
    drawing = false;
    ctx.beginPath();
}

function draw(e) {
    if (!drawing) return;
    
    const rect = canvas.getBoundingClientRect();
    let x, y;
    
    if (e.type.includes('touch')) {
        x = e.touches[0].clientX - rect.left;
        y = e.touches[0].clientY - rect.top;
    } else {
        x = e.clientX - rect.left;
        y = e.clientY - rect.top;
    }
    
    ctx.lineWidth = 12;
    ctx.lineCap = 'round';
    ctx.strokeStyle = currentColor;
    
    ctx.lineTo(x, y);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(x, y);
}

// Touch event handlers
function handleTouchStart(e) {
    e.preventDefault();
    const touch = e.touches[0];
    const mouseEvent = new MouseEvent("mousedown", {
        clientX: touch.clientX,
        clientY: touch.clientY
    });
    canvas.dispatchEvent(mouseEvent);
}

function handleTouchMove(e) {
    e.preventDefault();
    const touch = e.touches[0];
    const mouseEvent = new MouseEvent("mousemove", {
        clientX: touch.clientX,
        clientY: touch.clientY
    });
    canvas.dispatchEvent(mouseEvent);
}

function handleTouchEnd(e) {
    e.preventDefault();
    const mouseEvent = new MouseEvent("mouseup", {});
    canvas.dispatchEvent(mouseEvent);
}

// Clear canvas function
function clearCanvas() {
    ctx.fillStyle = '#FFF9F0';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
}

// ADD TO POND + SAVE TO DB (simulated for demo)
async function addToPond() {
    const imgData = canvas.toDataURL();
    
    // For demo purposes, we'll store in localStorage
    // In a real app, this would be sent to your backend
    let items = JSON.parse(localStorage.getItem('pondItems') || '[]');
    items.push({
        img: imgData,
        x: Math.random() * 80 + 10, 
        y: Math.random() * 60 + 20,
        timestamp: Date.now()
    });
    localStorage.setItem('pondItems', JSON.stringify(items));
    
    alert("Added to Pond!");
    clearCanvas();
    loadPondItems();
}

// LOAD POND ITEMS
async function loadPondItems() {
    // For demo, load from localStorage
    // In a real app, this would come from your backend
    const items = JSON.parse(localStorage.getItem('pondItems') || '[]');
    const container = document.getElementById("pondDrawings");
    container.innerHTML = "";

    items.forEach((item, i) => {
        setTimeout(() => {
            let img = document.createElement("img");
            img.src = item.img;
            img.style.left = item.x + "%";
            img.style.top = item.y + "%";
            // Add slight delay variation to floating animation for natural effect
            img.style.animationDelay = `${(i % 5) * 0.2}s`;
            container.appendChild(img);
        }, i * 250);
    });
}

// Initialize
loadPondItems();
</script>

</body>
</html>
